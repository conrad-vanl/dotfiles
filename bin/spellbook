#!/usr/bin/env bash
# ----------------------------------------------------
#
#   Spellbook
#   -> Download Spellbook files or copy to clipboard
#
# ----------------------------------------------------
#   Dependencies
# ----------------------------------------------------
#
#  - bash-comment
#  - download-zip
#
# ----------------------------------------------------

set -o errexit
set -o nounset
set -o pipefail

# ----------------------------------------------------
#   Variables
# ----------------------------------------------------

URL='https://raw.githubusercontent.com/spellbook/spellbook/master'

# ----------------------------------------------------
#   Error Handling
# ----------------------------------------------------

function _on-exit() {
  [ "$?" != 0 ] && echo 'File not found!'
}

trap _on-exit EXIT

# ----------------------------------------------------
#   Main
# ----------------------------------------------------

if (( "$#" == 0 )); then

  bash-comment s '...'
  download-zip 'https://github.com/spellbook/spellbook/archive/master.zip'
  bash-comment s 'Downloaded Spellbook to spellbook-master/'
  exit

fi

if [ "$1" != 'copy' ]; then

  bash-comment s '...'
  curl -fsO "$URL/$1/$2.coffee"
  bash-comment s "Downloaded $1/$2!"

else

  bash-comment s '...'
  curl -fs "$URL/$2/$3.coffee" | pbcopy
  bash-comment s "Copied $2/$3 to the clipboard!"

fi
